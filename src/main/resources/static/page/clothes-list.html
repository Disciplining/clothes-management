<!DOCTYPE html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="utf-8">
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">

        <title>衣物列表</title>

        <link rel="stylesheet" href="/assets/clotheslist/layui.css" media="all">
        <link rel="stylesheet" href="/assets/clotheslist/admin.css" media="all">
        <link rel="stylesheet" href="/assets/clotheslist/template.css" media="all">
        <script src="https://cdn.bootcss.com/vue/2.6.11/vue.min.js"></script>
        <script src="https://cdn.bootcss.com/axios/0.19.2/axios.min.js"></script>
        <style>
            div.price a
            {
                cursor: pointer;
            }
        </style>
    </head>

    <body>
        <div class="layui-fluid layadmin-cmdlist-fluid" id="app">
            <div class="layui-row layui-col-space30">

                <div v-for="item in clothes" class="layui-col-md2 layui-col-sm4">
                    <div class="cmdlist-container">
                        <img v-bind:src=item.url>
                        <div class="cmdlist-text">
                            <p class="info">{{item.cname}}</p>
                            <div class="price">
                                <a @click="delClothes(item.cid)">删除</a>
                                <a @click="upClothes(item.cid)">前移</a>
                                <a @click="downClothes(item.cid)">后移</a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <script>
            new Vue
            (
                {
                    el : '#app',
                    data:
                    {
                        clothes: []
                    },
                    methods:
                    {
                        getClothes: function() // 获得所有衣物
                        {
                            let that = this;
                            axios.get('/clothes/list/0')
                                .then
                                (
                                    function (response)
                                    {
                                        that.clothes = response.data.data;
                                    },
                                    function ()
                                    {
                                        console.log('请求失败');
                                    }
                                );
                        },
                        delClothes: function (cid) // 删除衣物
                        {
                            let that = this;
                            axios.delete('/clothes/remove/' + cid)
                                .then
                                (
                                    function (response)
                                    {
                                        that.getClothes();
                                    },
                                    function ()
                                    {
                                        alert('请求失败');
                                    }
                                );
                        },
                        upClothes: function (cid) // 前移一个衣物
                        {
                            let that = this;
                            axios.put('/clothes/sequence/' + cid + "?up=true")
                                .then
                                (
                                    function (response)
                                    {
                                        that.getClothes();
                                    },
                                    function ()
                                    {
                                        alert('请求失败');
                                    }
                                );
                        },
                        downClothes: function (cid) // 后移一个衣物
                        {
                            let that = this;
                            axios.put('/clothes/sequence/' + cid + "?up=false")
                                .then
                                (
                                    function (response)
                                    {
                                        that.getClothes();
                                    },
                                    function ()
                                    {
                                        alert('请求失败');
                                    }
                                );
                        }
                    },
                    created: function ()
                    {
                        this.getClothes();
                    }
                }
            );
        </script>
    </body>
</html>